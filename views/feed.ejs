<!-- Show success/error messages -->
    <% if (typeof success !== 'undefined' && success) { %>
        <div class="alert alert-success">
            <% if (success === 'post_criado') { %>
                ✓ Postagem criada com sucesso!
            <% } %>
        </div>
    <% } %>
    
    <% if (typeof error !== 'undefined' && error) { %>
        <div class="alert alert-error">
            <% if (error === 'missing_fields') { %>
                ⚠ Por favor, preencha todos os campos obrigatórios.
            <% } else if (error === 'no_content') { %>
                ⚠ Por favor, adicione um conteúdo ou uma imagem.
            <% } else if (error === 'creation_failed') { %>
                ✗ Erro ao criar postagem. Tente novamente.
            <% } else { %>
                ✗ <%= error %>
            <% } %>
        </div>
    <% } %>

<div class="feed-container">
    <% if (posts && posts.length > 0) { %>
        <% posts.forEach(post => { %>
            <article class="post-card">
                <% if (post.imagens && post.imagens.length > 0) { %>
                    <div class="post-images">
                        <% post.imagens.forEach(imagem => { %>
                            <img src="<%= imagem.url %>" alt="<%= post.titulo %>" class="post-image">
                        <% }); %>
                    </div>
                <% } else { %>
                    <div class="no-image-placeholder">
                        <span class="material-symbols-outlined">image</span>
                        <p>Sem imagem</p>
                    </div>
                <% } %>
                <div class="post-card-content">
                    <h3><%= post.titulo %></h3>
                    <% if (post.conteudo) { %>
                        <p><%= post.conteudo %></p>
                    <% } %>
                    <div class="post-meta">
                        <div class="d-flex align-center gap-2">
                            <% if (post.autor) { %>
                                <span class="post-author">@<%= post.autor.nomeUsuario %></span>
                            <% } %>
                        </div>
                        <div class="d-flex align-center gap-2">
                            <span class="post-category"><%= post.categoria %></span>
                        </div>
                    </div>
                </div>
                <div class="post-actions">
                    <button class="post-action-btn">
                        <span class="material-symbols-outlined">favorite_border</span>
                        <span>Curtir</span>
                    </button>
                    <button class="post-action-btn">
                        <span class="material-symbols-outlined">comment</span>
                        <span>Comentar</span>
                    </button>
                    <button class="post-action-btn">
                        <span class="material-symbols-outlined">share</span>
                        <span>Compartilhar</span>
                    </button>
                </div>
            </article>
        <% }); %>
    <% } else { %>
        <div class="no-posts">
            <span class="material-symbols-outlined">post_add</span>
            <h3>Nenhuma postagem encontrada</h3>
            <p>Seja o primeiro a compartilhar sua arte!</p>
            <button class="btn btn-primary" onclick="document.getElementById('btn-criar-postagem')?.click()">
                <span class="material-symbols-outlined">add</span>
                Criar Primeira Postagem
            </button>
        </div>
    <% } %>
</div>

<style>
.alert {
    padding: 12px 16px;
    margin-bottom: 20px;
    border-radius: 6px;
    font-weight: 500;
}

.alert-success {
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
}

.alert-error {
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
}
</style>